(window.webpackJsonp=window.webpackJsonp||[]).push([[185],{582:function(t,s,a){"use strict";a.r(s);var n=a(2),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"_4-mongodb-çš„ç´¢å¼•"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-mongodb-çš„ç´¢å¼•"}},[t._v("#")]),t._v(" 4. MongoDB çš„ç´¢å¼•")]),t._v(" "),s("h3",{attrs:{id:"_4-1-æ¦‚è¿°"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-æ¦‚è¿°"}},[t._v("#")]),t._v(" 4.1 æ¦‚è¿°")]),t._v(" "),s("p",[t._v("ç´¢å¼•æ”¯æŒåœ¨ MongoDB ä¸­é«˜æ•ˆåœ°æ‰§è¡ŒæŸ¥è¯¢.å¦‚æœæ²¡æœ‰ç´¢å¼•, MongoDB å¿…é¡»æ‰§è¡Œå…¨é›†åˆæ‰«æ, å³æ‰«æé›†åˆä¸­çš„æ¯ä¸ªæ–‡æ¡£, ä»¥é€‰æ‹©ä¸æŸ¥è¯¢è¯­å¥ åŒ¹é…çš„æ–‡æ¡£.è¿™ç§æ‰«æå…¨é›†åˆçš„æŸ¥è¯¢æ•ˆç‡æ˜¯éå¸¸ä½çš„, ç‰¹åˆ«åœ¨å¤„ç†å¤§é‡çš„æ•°æ®æ—¶, æŸ¥è¯¢å¯ä»¥è¦èŠ±è´¹å‡ åç§’ç”šè‡³å‡ åˆ†é’Ÿ, è¿™å¯¹ç½‘ç«™çš„æ€§èƒ½æ˜¯éå¸¸è‡´å‘½çš„.")]),t._v(" "),s("p",[t._v("å¦‚æœæŸ¥è¯¢å­˜åœ¨é€‚å½“çš„ç´¢å¼•, MongoDB å¯ä»¥ä½¿ç”¨è¯¥ç´¢å¼•é™åˆ¶å¿…é¡»æ£€æŸ¥çš„æ–‡æ¡£æ•°.")]),t._v(" "),s("p",[t._v("ç´¢å¼•æ˜¯ç‰¹æ®Šçš„æ•°æ®ç»“æ„, å®ƒä»¥æ˜“äºéå†çš„å½¢å¼å­˜å‚¨é›†åˆæ•°æ®é›†çš„ä¸€å°éƒ¨åˆ†.ç´¢å¼•å­˜å‚¨ç‰¹å®šå­—æ®µæˆ–ä¸€ç»„å­—æ®µçš„å€¼, æŒ‰å­—æ®µå€¼æ’åº.ç´¢å¼•é¡¹çš„æ’ åºæ”¯æŒæœ‰æ•ˆçš„ç›¸ç­‰åŒ¹é…å’ŒåŸºäºèŒƒå›´çš„æŸ¥è¯¢æ“ä½œ.æ­¤å¤–, MongoDB è¿˜å¯ä»¥ä½¿ç”¨ç´¢å¼•ä¸­çš„æ’åºè¿”å›æ’åºç»“æœ.")]),t._v(" "),s("p",[t._v("MongoDB ä½¿ç”¨çš„æ˜¯ B Tree, MySQL ä½¿ç”¨çš„æ˜¯ B+ Tree")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// create index")]),t._v("\ndb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("collection_name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createIndex")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("userid")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("username")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// retrieve indexes")]),t._v("\ndb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("collection_name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getIndexes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// remove indexes")]),t._v("\ndb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("collection_name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dropIndex")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// there are 2 ways to remove indexes:")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1. removed based on the index name")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2. removed based on the fields")]),t._v("\n\ndb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("collection_name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dropIndex")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"userid_1_username_-1"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ndb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("collection_name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dropIndex")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("userid")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("username")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// remove all the indexes, will only remove non_id indexes")]),t._v("\ndb"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("collection_name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dropIndexes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br")])]),s("h3",{attrs:{id:"_4-2-ç´¢å¼•çš„ç±»å‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-ç´¢å¼•çš„ç±»å‹"}},[t._v("#")]),t._v(" 4.2 ç´¢å¼•çš„ç±»å‹")]),t._v(" "),s("h4",{attrs:{id:"_4-2-1-å•å­—æ®µç´¢å¼•"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-1-å•å­—æ®µç´¢å¼•"}},[t._v("#")]),t._v(" 4.2.1 å•å­—æ®µç´¢å¼•")]),t._v(" "),s("p",[t._v("MongoDB æ”¯æŒåœ¨æ–‡æ¡£çš„å•ä¸ªå­—æ®µä¸Šåˆ›å»ºç”¨æˆ·å®šä¹‰çš„"),s("strong",[t._v("å‡åº/é™åºç´¢å¼•")]),t._v(", ç§°ä¸º"),s("strong",[t._v("å•å­—æ®µç´¢å¼•")]),t._v(" Single Field Index")]),t._v(" "),s("p",[t._v("å¯¹äºå•ä¸ªå­—æ®µç´¢å¼•å’Œæ’åºæ“ä½œ, ç´¢å¼•é”®çš„æ’åºé¡ºåºï¼ˆå³å‡åºæˆ–é™åºï¼‰å¹¶ä¸é‡è¦, å› ä¸º MongoDB å¯ä»¥åœ¨ä»»ä½•æ–¹å‘ä¸Šéå†ç´¢å¼•.")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20200505231043779.png",alt:"img"}})]),t._v(" "),s("h4",{attrs:{id:"_4-2-2-å¤åˆç´¢å¼•"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-2-å¤åˆç´¢å¼•"}},[t._v("#")]),t._v(" 4.2.2 å¤åˆç´¢å¼•")]),t._v(" "),s("p",[t._v("MongoDB è¿˜æ”¯æŒå¤šä¸ªå­—æ®µçš„ç”¨æˆ·å®šä¹‰ç´¢å¼•, å³å¤åˆç´¢å¼• Compound Index")]),t._v(" "),s("p",[t._v("å¤åˆç´¢å¼•ä¸­åˆ—å‡ºçš„å­—æ®µé¡ºåºå…·æœ‰é‡è¦æ„ä¹‰.ä¾‹å¦‚, å¦‚æœå¤åˆç´¢å¼•ç”± "),s("code",[t._v("{ userid: 1, score: -1 }")]),t._v(" ç»„æˆ, åˆ™ç´¢å¼•é¦–å…ˆæŒ‰ "),s("code",[t._v("userid")]),t._v(" æ­£åºæ’åº, ç„¶å åœ¨æ¯ä¸ª "),s("code",[t._v("userid")]),t._v(" çš„å€¼å†…, å†åœ¨æŒ‰ "),s("code",[t._v("score")]),t._v(" å€’åºæ’åº.")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20200505231305941.png",alt:"img"}})]),t._v(" "),s("h4",{attrs:{id:"_4-2-3-å…¶ä»–ç´¢å¼•"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-3-å…¶ä»–ç´¢å¼•"}},[t._v("#")]),t._v(" 4.2.3 å…¶ä»–ç´¢å¼•")]),t._v(" "),s("ul",[s("li",[t._v("åœ°ç†ç©ºé—´ç´¢å¼• Geospatial Index")]),t._v(" "),s("li",[t._v("æ–‡æœ¬ç´¢å¼• Text Indexes")]),t._v(" "),s("li",[t._v("å“ˆå¸Œç´¢å¼• Hashed Indexes")])]),t._v(" "),s("h5",{attrs:{id:"åœ°ç†ç©ºé—´ç´¢å¼•-geospatial-index"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#åœ°ç†ç©ºé—´ç´¢å¼•-geospatial-index"}},[t._v("#")]),t._v(" åœ°ç†ç©ºé—´ç´¢å¼•ï¼ˆGeospatial Indexï¼‰")]),t._v(" "),s("p",[t._v("ä¸ºäº†æ”¯æŒå¯¹åœ°ç†ç©ºé—´åæ ‡æ•°æ®çš„æœ‰æ•ˆæŸ¥è¯¢, MongoDB æä¾›äº†ä¸¤ç§ç‰¹æ®Šçš„ç´¢å¼•: è¿”å›ç»“æœæ—¶ä½¿ç”¨å¹³é¢å‡ ä½•çš„äºŒç»´ç´¢å¼•å’Œè¿”å›ç»“æœæ—¶ä½¿ç”¨çƒé¢å‡ ä½•çš„äºŒç»´çƒé¢ç´¢å¼•.")]),t._v(" "),s("h5",{attrs:{id:"æ–‡æœ¬ç´¢å¼•-text-indexes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#æ–‡æœ¬ç´¢å¼•-text-indexes"}},[t._v("#")]),t._v(" æ–‡æœ¬ç´¢å¼•ï¼ˆText Indexesï¼‰")]),t._v(" "),s("p",[t._v("MongoDB æä¾›äº†ä¸€ç§æ–‡æœ¬ç´¢å¼•ç±»å‹, æ”¯æŒåœ¨é›†åˆä¸­æœç´¢å­—ç¬¦ä¸²å†…å®¹.è¿™äº›æ–‡æœ¬ç´¢å¼•ä¸å­˜å‚¨ç‰¹å®šäºè¯­è¨€çš„åœæ­¢è¯ï¼ˆä¾‹å¦‚ â€œtheâ€, â€œaâ€, â€œorâ€ï¼‰, è€Œå°†é›†åˆä¸­çš„è¯ä½œä¸ºè¯å¹², åªå­˜å‚¨æ ¹è¯.")]),t._v(" "),s("h5",{attrs:{id:"å“ˆå¸Œç´¢å¼•-hashed-indexes"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#å“ˆå¸Œç´¢å¼•-hashed-indexes"}},[t._v("#")]),t._v(" å“ˆå¸Œç´¢å¼•ï¼ˆHashed Indexesï¼‰")]),t._v(" "),s("p",[t._v("ä¸ºäº†æ”¯æŒåŸºäºæ•£åˆ—çš„åˆ†ç‰‡, MongoDB æä¾›äº†æ•£åˆ—ç´¢å¼•ç±»å‹, å®ƒå¯¹å­—æ®µå€¼çš„æ•£åˆ—è¿›è¡Œç´¢å¼•.è¿™äº›ç´¢å¼•åœ¨å…¶èŒƒå›´å†…çš„å€¼åˆ†å¸ƒæ›´åŠ éšæœº, ä½†åªæ”¯æŒç›¸ç­‰åŒ¹é…, ä¸æ”¯æŒåŸºäºèŒƒå›´çš„æŸ¥è¯¢.")]),t._v(" "),s("h3",{attrs:{id:"_4-3-ç´¢å¼•çš„ç®¡ç†æ“ä½œ"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-ç´¢å¼•çš„ç®¡ç†æ“ä½œ"}},[t._v("#")]),t._v(" 4.3 ç´¢å¼•çš„ç®¡ç†æ“ä½œ")]),t._v(" "),s("h4",{attrs:{id:"_4-3-1-ç´¢å¼•çš„æŸ¥çœ‹"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-1-ç´¢å¼•çš„æŸ¥çœ‹"}},[t._v("#")]),t._v(" 4.3.1 ç´¢å¼•çš„æŸ¥çœ‹")]),t._v(" "),s("p",[t._v("è¯­æ³•")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("db"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("collection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("getIndexes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20221116210849516.png",alt:"image-20221116210849516"}})]),t._v(" "),s("p",[t._v("é»˜è®¤ "),s("code",[t._v("_id")]),t._v(" ç´¢å¼•ï¼š MongoDB åœ¨åˆ›å»ºé›†åˆçš„è¿‡ç¨‹ä¸­, åœ¨ "),s("code",[t._v("_id")]),t._v(" å­—æ®µä¸Šåˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„ç´¢å¼•, é»˜è®¤åå­—ä¸º "),s("code",[t._v("_id")]),t._v(" , è¯¥ç´¢å¼•å¯é˜²æ­¢å®¢æˆ·ç«¯æ’å…¥ä¸¤ä¸ªå…·æœ‰ç›¸åŒå€¼çš„æ–‡ æ¡£, ä¸èƒ½åœ¨ "),s("code",[t._v("_id")]),t._v(" å­—æ®µä¸Šåˆ é™¤æ­¤ç´¢å¼•.")]),t._v(" "),s("p",[t._v("æ³¨æ„ï¼šè¯¥ç´¢å¼•æ˜¯"),s("strong",[t._v("å”¯ä¸€ç´¢å¼•")]),t._v(", å› æ­¤å€¼ä¸èƒ½é‡å¤, å³ "),s("code",[t._v("_id")]),t._v(" å€¼ä¸èƒ½é‡å¤çš„.")]),t._v(" "),s("p",[t._v("åœ¨åˆ†ç‰‡é›†ç¾¤ä¸­, é€šå¸¸ä½¿ç”¨ "),s("code",[t._v("_id")]),t._v(" ä½œä¸º"),s("strong",[t._v("ç‰‡é”®")]),t._v(".")]),t._v(" "),s("h4",{attrs:{id:"_4-3-2-ç´¢å¼•çš„åˆ›å»º"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-2-ç´¢å¼•çš„åˆ›å»º"}},[t._v("#")]),t._v(" 4.3.2 ç´¢å¼•çš„åˆ›å»º")]),t._v(" "),s("p",[t._v("è¯­æ³•")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("db"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("collection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createIndex")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("keys"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("å‚æ•°")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20200506203419523.png",alt:"image-20200506203419523"}})]),t._v(" "),s("p",[t._v("optionsï¼ˆæ›´å¤šé€‰é¡¹ï¼‰åˆ—è¡¨")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20200506203453430.png",alt:"image-20200506203453430"}})]),t._v(" "),s("p",[t._v("æ³¨æ„åœ¨ 3.0.0 ç‰ˆæœ¬å‰åˆ›å»ºç´¢å¼•æ–¹æ³•ä¸º "),s("code",[t._v("db.collection.ensureIndex()")]),t._v(" , ä¹‹åçš„ç‰ˆæœ¬ä½¿ç”¨äº† "),s("code",[t._v("db.collection.createIndex()")]),t._v(" æ–¹æ³•, "),s("code",[t._v("ensureIndex()")]),t._v(" è¿˜èƒ½ç”¨, ä½†åªæ˜¯ "),s("code",[t._v("createIndex()")]),t._v(" çš„åˆ«å.")]),t._v(" "),s("p",[t._v("ä¸¾ä¸ªğŸŒ°")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("$  db"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("comment"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createIndex")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("userid")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"createdCollectionAutomatically"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"numIndexesBefore"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"numIndexesAfter"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token string-property property"}},[t._v('"ok"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n$ db"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("comment"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createIndex")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("userid")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("nickname")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br")])]),s("h4",{attrs:{id:"_4-3-3-ç´¢å¼•çš„åˆ é™¤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-3-ç´¢å¼•çš„åˆ é™¤"}},[t._v("#")]),t._v(" 4.3.3 ç´¢å¼•çš„åˆ é™¤")]),t._v(" "),s("p",[t._v("è¯­æ³•")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("# åˆ é™¤æŸä¸€ä¸ªç´¢å¼•\n$ db"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("collection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dropIndex")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("index"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n# example"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" db"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dropIndex")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("æˆ–è€…æ‹¬å·é‡Œå†™ç´¢å¼•åç§°ä¹Ÿè¡Œ\n# åˆ é™¤å…¨éƒ¨ç´¢å¼•\n$ db"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("collection"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("dropIndexes")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("p",[t._v("æç¤º:")]),t._v(" "),s("p",[s("code",[t._v("_id")]),t._v(" çš„å­—æ®µçš„ç´¢å¼•æ˜¯æ— æ³•åˆ é™¤çš„, åªèƒ½åˆ é™¤é "),s("code",[t._v("_id")]),t._v(" å­—æ®µçš„ç´¢å¼•")]),t._v(" "),s("p",[t._v("ç¤ºä¾‹")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("# åˆ é™¤ comment é›†åˆä¸­ userid å­—æ®µä¸Šçš„å‡åºç´¢å¼•\n$ db.comment.dropIndex({userid:1})\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("h3",{attrs:{id:"_4-4-ç´¢å¼•ä½¿ç”¨"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-ç´¢å¼•ä½¿ç”¨"}},[t._v("#")]),t._v(" 4.4 ç´¢å¼•ä½¿ç”¨")]),t._v(" "),s("h4",{attrs:{id:"_4-4-1-æ‰§è¡Œè®¡åˆ’"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-1-æ‰§è¡Œè®¡åˆ’"}},[t._v("#")]),t._v(" 4.4.1 æ‰§è¡Œè®¡åˆ’")]),t._v(" "),s("p",[t._v("åˆ†ææŸ¥è¯¢æ€§èƒ½ (Analyze Query Performance) é€šå¸¸ä½¿ç”¨æ‰§è¡Œè®¡åˆ’ (è§£é‡Šè®¡åˆ’ - Explain Plan) æ¥æŸ¥çœ‹æŸ¥è¯¢çš„æƒ…å†µ"),s("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20221116211755937.png",alt:"image-20221116211755937"}})]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[t._v("$ db"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("collection_name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v(" query"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("explain")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("æ¯”å¦‚: æŸ¥çœ‹æ ¹æ® "),s("code",[t._v("user_id")]),t._v(" æŸ¥è¯¢æ•°æ®çš„æƒ…å†µ")]),t._v(" "),s("p",[s("strong",[t._v("æœªæ·»åŠ ç´¢å¼•ä¹‹å‰")])]),t._v(" "),s("p",[s("code",[t._v('"stage" : "COLLSCAN"')]),t._v(", è¡¨ç¤ºå…¨é›†åˆæ‰«æ")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20200506205714154.png",alt:"img"}})]),t._v(" "),s("p",[s("strong",[t._v("æ·»åŠ ç´¢å¼•ä¹‹å")])]),t._v(" "),s("p",[s("code",[t._v('"stage" : "IXSCAN"')]),t._v(", åŸºäºç´¢å¼•çš„æ‰«æ")]),t._v(" "),s("h4",{attrs:{id:"_4-4-2-æ¶µç›–çš„æŸ¥è¯¢"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-4-2-æ¶µç›–çš„æŸ¥è¯¢"}},[t._v("#")]),t._v(" 4.4.2 æ¶µç›–çš„æŸ¥è¯¢")]),t._v(" "),s("p",[t._v("å½“æŸ¥è¯¢æ¡ä»¶å’ŒæŸ¥è¯¢çš„æŠ•å½±ä»…åŒ…å«ç´¢å¼•å­—æ®µæ˜¯, MongoDB ç›´æ¥ä»ç´¢å¼•è¿”å›ç»“æœ, è€Œä¸æ‰«æä»»ä½•æ–‡æ¡£æˆ–å°†æ–‡æ¡£å¸¦å…¥å†…å­˜, è¿™äº›è¦†ç›–çš„æŸ¥è¯¢ååˆ†æœ‰æ•ˆ"),s("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20221116213000930.png",alt:"image-20221116213000930"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://markdown-1301334775.cos.eu-frankfurt.myqcloud.com/image-20221116213107064.png",alt:"image-20221116213107064"}})]),t._v(" "),s("blockquote",[s("p",[t._v("https://docs.mongodb.com/manual/core/query-optimization/#covered-query")])])])}),[],!1,null,null,null);s.default=e.exports}}]);